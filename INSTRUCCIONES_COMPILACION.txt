â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    INSTRUCCIONES PARA COMPILAR A EJECUTABLE
    Descargador de GLOSAS - Hospital Universitario del Valle
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“‹ REQUISITOS PREVIOS:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Python 3.8 o superior instalado
2. Todas las dependencias instaladas (ver secciÃ³n INSTALACIÃ“N DE DEPENDENCIAS)
3. Archivo credentials.json en la misma carpeta del script


ğŸ“¦ INSTALACIÃ“N DE DEPENDENCIAS:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Ejecuta este comando en la terminal (CMD o PowerShell):

    pip install google-auth google-auth-oauthlib google-auth-httplib2 google-api-python-client pyinstaller


ğŸ”¨ COMPILAR A EJECUTABLE (.EXE):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Abre la terminal (CMD o PowerShell) en la carpeta del proyecto:

   cd "C:\Users\Soporte\Desktop\Proyectos HUV\automatizacion glosas"


2. Ejecuta el siguiente comando para compilar:

   pyinstaller --onefile --windowed --name "Descargador_GLOSAS_HUV" --add-data "credentials.json;." --icon=NONE glosas_file_downloader.py


3. El ejecutable se crearÃ¡ en la carpeta:
   dist\Descargador_GLOSAS_HUV.exe


ğŸ“ EXPLICACIÃ“N DE LOS PARÃMETROS:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
--onefile          : Crea un solo archivo ejecutable
--windowed         : No muestra consola de comandos (solo ventanas grÃ¡ficas)
--name             : Nombre del ejecutable final
--add-data         : Incluye credentials.json dentro del ejecutable
--icon=NONE        : Sin Ã­cono personalizado (opcional: agregar .ico despuÃ©s)


ğŸ“ DISTRIBUCIÃ“N AL USUARIO:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Entregar Ãºnicamente el archivo:
    âœ“ dist\Descargador_GLOSAS_HUV.exe

El usuario NO necesita:
    âœ— Python instalado
    âœ— LibrerÃ­as adicionales
    âœ— El archivo credentials.json (ya estÃ¡ embebido)


âš™ï¸ CONFIGURACIÃ“N EN EL EQUIPO DEL USUARIO:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Primera ejecuciÃ³n:
   - Se abrirÃ¡ el navegador para autenticaciÃ³n con Gmail
   - Debe autorizar el acceso a la cuenta: glosasydevoluciones@correohuv.gov.co

2. UbicaciÃ³n de archivos:
   - Token de autenticaciÃ³n: %LOCALAPPDATA%\GlosasAutomatizador\token.json
   - Log de actividad: %LOCALAPPDATA%\GlosasAutomatizador\glosas_downloader.log
   - IDs procesados: %LOCALAPPDATA%\GlosasAutomatizador\processed_ids.json

3. Archivos descargados:
   - Se crea un ZIP en el ESCRITORIO con estructura de carpetas organizadas


ğŸ¨ MEJORAS VISUALES IMPLEMENTADAS:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ“ Ventana de progreso con diseÃ±o profesional
  - Header azul con logo del HUV
  - Ãconos descriptivos
  - Barra de progreso estilizada
  - Contador de mensajes y archivos en tiempo real

âœ“ Ventana de selecciÃ³n de fechas mejorada
  - DiseÃ±o moderno con colores corporativos
  - Botones mÃ¡s grandes y visibles
  - Valores por defecto (Ãºltimos 30 dÃ­as)

âœ“ Mensajes informativos con emojis
  - MÃ¡s claros y profesionales
  - Mejor estructura visual


ğŸ“Š ESTRUCTURA DEL ZIP RESULTANTE:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
GLOSAS_YYYYMMDD_HHMMSS.zip
â”œâ”€â”€ 2025-Octubre/
â”‚   â”œâ”€â”€ Semana_43/
â”‚   â”‚   â”œâ”€â”€ 2025-10-22_GLOSAS PRESTADOR...pdf
â”‚   â”‚   â””â”€â”€ 2025-10-23_GLOSAS PRESTADOR...pdf
â”‚   â””â”€â”€ Semana_44/
â””â”€â”€ 2025-Noviembre/
    â”œâ”€â”€ Semana_45/
    â””â”€â”€ Semana_47/
        â”œâ”€â”€ 2025-11-18_GLOSAS PRESTADOR...pdf
        â””â”€â”€ 2025-11-21_GLOSAS PRESTADOR...pdf


âš ï¸ IMPORTANTE:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â€¢ Este programa SOLO debe usarse con: glosasydevoluciones@correohuv.gov.co
â€¢ Los nombres de carpetas usan nombres de meses en espaÃ±ol
â€¢ Los archivos incluyen la fecha del correo en el nombre
â€¢ Se mantiene registro de archivos ya descargados para evitar duplicados


ğŸ’¡ SOLUCIÃ“N DE PROBLEMAS:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Si el ejecutable no funciona:
1. Verificar que credentials.json sea vÃ¡lido
2. Revisar el log en: %LOCALAPPDATA%\GlosasAutomatizador\glosas_downloader.log
3. Ejecutar una vez con Python para ver errores en consola:
   python glosas_file_downloader.py


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    Desarrollado por: InnovaciÃ³n y Desarrollo HUV
    Contacto: innovacionydesarrollo@correohuv.gov.co
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
